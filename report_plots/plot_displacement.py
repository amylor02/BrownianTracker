import matplotlib.pyplot as plt
import numpy as np
from scipy.optimize import curve_fit
import math


data = """
45.438018798828125 20.9794921875  354
18.44677734375 -35.487060546875  215
11.48046875 -31.824951171875  32
19.2276611328125 47.5162353515625  284
-19.51318359375 -0.5466461181640625  66
8.0478515625 7.240478515625  14
27.850372314453125 -36.42242431640625  213
0.107421875 3.5335693359375  5
-32.2940673828125 -37.644287109375  429
6.48828125 -13.306838989257812  32
7.869140625 -13.35302734375  28
-37.9541015625 -11.787460327148438  32
-2.60693359375 0.371337890625  3
1.6013164520263672 -6.836669921875  3
1.52178955078125 16.5208740234375  253
1.6997556686401367 -1.145263671875  3
-10.78582763671875 -12.39453125  11
6.314178466796875 16.384765625  4
-2.9542236328125 -10.805908203125  11
-4.9464111328125 -12.68353271484375  147
35.34814453125 -1.28955078125  155
-5.2896728515625 8.65869140625  285
-5.54638671875 -13.566650390625  107
-25.320098876953125 10.997177124023438  97
-4.603229522705078 -4.4229736328125  8
23.0714111328125 -7.1572265625  355
16.016845703125 22.35400390625  16
-2.4079761505126953 -2.017059326171875  3
39.2744140625 -84.2520751953125  -1 
-4.10205078125 -13.821044921875  57
-5.7086181640625 0.6986083984375  9
14.4986572265625 -32.991943359375  299
2.6834888458251953 -1.5550537109375  19
23.5382080078125 -1.876953125  113
-31.357177734375 -5.7362060546875  269
-6.430419921875 6.3433837890625  17
19.99951171875 -5.248870849609375  11
28.6971435546875 -4.286865234375  247
-25.8167724609375 -5.30865478515625  94
17.15234375 -5.8155517578125  76
15.5379638671875 -3.02392578125  107
9.7283935546875 1.783935546875  3
-7.04510498046875 -10.1923828125  41
-32.5867919921875 29.113677978515625  194
-1.327138900756836 -10.71728515625  33
-3.8865509033203125 23.04736328125  23
-12.864501953125 -42.694091796875  204
-4.572998046875 -3.29052734375  15
-10.7650146484375 -39.90521240234375  142
2.42449951171875 -0.1329345703125  3
-2.617919921875 4.7587890625  3
-11.31982421875 3.033620834350586  3
1.427093505859375 -35.53729248046875  7
-4.398529052734375 12.7547607421875  3
-15.24591064453125 -13.95697021484375  29
44.31591796875 20.838623046875  155
15.0185546875 -10.6861572265625  23
-1.092529296875 7.015289306640625  10
-6.7698974609375 22.5914306640625  89
12.648681640625 -5.64892578125  5
3.871337890625 5.937978744506836  4
2.7841796875 -12.4234619140625  123
37.19314765930176 32.37353515625  125
8.653411865234375 -1.8779296875  10
-1.7806396484375 -3.747802734375  3
-41.813720703125 3.9239044189453125  55
-2.99365234375 5.551704406738281  45
12.068405151367188 10.7789306640625  7
48.30810546875 -2.6280517578125  68
-25.6702880859375 13.96112060546875  74
51.375732421875 -11.82550048828125  72
0.763092041015625 3.897705078125  58
-4.8353271484375 7.2152099609375  52
2.592987060546875 7.1030120849609375  34
8.81109619140625 19.919921875  32
-5.27001953125 -5.43927001953125  30
"""

data2 = """
52.7330322265625 15.668212890625 346
19.953857421875 -37.7503662109375 206
13.986328125 -24.82037353515625 19
19.653076171875 47.104339599609375 279
0.926025390625 6.548828125 7
-30.92425537109375 -39.371826171875 404
0.89111328125 -5.34893798828125 14
7.136077880859375 -3.808349609375 7
0.0 0.0 1
8.49755859375 -3.97027587890625 135
12.17572021484375 25.1409912109375 234
27.7734375 6.74365234375 119
15.7845458984375 -0.870849609375 250
21.677772521972656 -35.7039794921875 139
-3.2412109375 -2.4241943359375 68
-23.29608154296875 10.065399169921875 81
18.7353515625 -9.3001708984375 327
46.909912109375 -61.05908203125 127
-27.378662109375 -8.29266357421875 258
17.8292236328125 0.39501953125 109
30.0780029296875 -7.51123046875 224
13.3497314453125 -10.357421875 62
0.0 0.0 1
15.835693359375 -3.069091796875 96
0.0 0.0 1
24.2972412109375 -9.60888671875 272
-0.1953125 -2.1954803466796875 57
7.0257568359375 0.6658935546875 25
-4.3319549560546875 9.6781005859375 11
-12.864501953125 -42.694091796875 198
56.2945556640625 35.324951171875 105
21.9208984375 9.787994384765625 178
0.86767578125 -15.4296875 116
-14.4456787109375 3.9915771484375 69
0.0 0.0 1
-4.828857421875 -39.805328369140625 105
-6.0283203125 1.680908203125 138
-3.3782958984375 3.02105712890625 42
0.0 0.0 1
-1.1680946350097656 6.8883056640625 5
11.627716064453125 -3.7528076171875 53
-30.17950439453125 14.73858642578125 70
42.7099609375 -14.275390625 56
18.861328125 -3.1990966796875 38
-8.355224609375 7.3570556640625 50
0.0 0.0 1
2.592987060546875 7.1030120849609375 34
2.4907188415527344 10.913330078125 5
-5.27001953125 -5.43927001953125 30
10.587890625 21.00732421875 30
"""

data3 = """
45.438018798828125 20.9794921875 354
18.44677734375 -35.487060546875 215
11.48046875 -31.824951171875 32
19.2276611328125 47.5162353515625 284
-8.53399658203125 1.84619140625 139
1.3701171875 20.929039001464844 226
8.0478515625 7.240478515625 14
3.6328125 2.21722412109375 28
-0.69775390625 0.08251953125 2
0.0966796875 -0.5116176605224609 2
-6.103363037109375 -3.284210205078125 4
5.0401611328125 8.5477294921875 29
27.850372314453125 -36.42242431640625 213
0.107421875 3.5335693359375 5
7.517578125 -5.036865234375 4
-62.337646484375 -26.109375 498
105.22314453125 -8.74200439453125 323
-17.8892822265625 10.182464599609375 152
6.48828125 -13.306838989257812 32
41.954153060913086 -5.25146484375 154
7.869140625 -13.35302734375 28
-1.77685546875 1.0103759765625 3
-37.9541015625 -11.787460327148438 32
0.0 0.0 1
13.330322265625 -52.83924865722656 181
0.0 0.0 1
0.0 0.0 1
-2.60693359375 0.371337890625 3
4.933349609375 10.823944091796875 11
22.30126953125 -10.71905517578125 84
-7.13720703125 2.889892578125 21
1.52178955078125 16.5208740234375 253
1.6997556686401367 -1.145263671875 3
2.059814453125 -3.94140625 5
-10.78582763671875 -12.39453125 11
6.314178466796875 16.384765625 4
49.370849609375 4.9888916015625 114
40.689697265625 -2.24560546875 103
0.0 0.0 1
-2.9542236328125 -10.805908203125 11
-4.9464111328125 -12.68353271484375 147
35.34814453125 -1.28955078125 155
-5.2896728515625 8.65869140625 285
30.948348999023438 -2.53887939453125 37
30.92724609375 -20.72308349609375 230
10.2449951171875 8.89013671875 21
-5.54638671875 -13.566650390625 107
8.75927734375 7.2373046875 3
11.7528076171875 -16.30615234375 82
-25.320098876953125 10.997177124023438 97
-4.603229522705078 -4.4229736328125 8
18.35107421875 5.2994384765625 69
2.80389404296875 7.584259033203125 4
-0.5732421875 -0.9036865234375 3
23.0714111328125 -7.1572265625 355
23.1744384765625 -20.40869140625 69
16.63818359375 -22.41192626953125 47
19.71783447265625 -16.41400146484375 27
-9.69757080078125 -21.8204345703125 178
16.016845703125 22.35400390625 16
-2.4079761505126953 -2.017059326171875 3
39.2744140625 -84.2520751953125 296
0.0 0.0 1
-4.10205078125 -13.821044921875 57
0.0 0.0 1
-5.7086181640625 0.6986083984375 9
87.79766845703125 -49.507080078125 320
14.4986572265625 -32.991943359375 299
2.6834888458251953 -1.5550537109375 19
23.5382080078125 -1.876953125 113
-31.357177734375 -5.7362060546875 269
72.1190185546875 11.8238525390625 290
19.99951171875 -5.248870849609375 11
21.364013671875 -33.3133544921875 130
-20.260009765625 2.245361328125 132
8.1390380859375 -21.876220703125 139
28.6971435546875 -4.286865234375 247
-25.8167724609375 -5.30865478515625 94
29.17138671875 -26.643310546875 294
7.10400390625 25.875732421875 53
17.15234375 -5.8155517578125 76
4.78369140625 12.2440185546875 71
15.5379638671875 -3.02392578125 107
-13.385498046875 -58.72747802734375 91
48.333251953125 -35.17132568359375 215
-8.67578125 -0.2672119140625 75
-2.0339508056640625 -10.022216796875 11
31.146728515625 26.83489990234375 67
-0.042572021484375 6.70361328125 12
0.0 0.0 1
9.7283935546875 1.783935546875 3
-7.04510498046875 -10.1923828125 41
0.0 0.0 1
-32.5867919921875 29.113677978515625 194
-1.327138900756836 -10.71728515625 33
-3.8865509033203125 23.04736328125 23
-12.864501953125 -42.694091796875 204
36.8818359375 -13.63818359375 164
-4.572998046875 -3.29052734375 15
-10.7650146484375 -39.90521240234375 142
0.0 0.0 1
2.42449951171875 -0.1329345703125 3
0.0 0.0 1
12.2940673828125 10.288497924804688 19
0.0 0.0 1
-11.31982421875 3.033620834350586 3
1.427093505859375 -35.53729248046875 7
-4.398529052734375 12.7547607421875 3
-40.554443359375 13.4541015625 131
0.0 0.0 1
-15.24591064453125 -13.95697021484375 29
44.31591796875 20.838623046875 155
32.1053466796875 -20.56427001953125 111
15.0185546875 -10.6861572265625 23
-1.092529296875 7.015289306640625 10
0.0 0.0 1
-3.463134765625 -26.45849609375 97
-6.7698974609375 22.5914306640625 89
3.871337890625 5.937978744506836 4
2.7841796875 -12.4234619140625 123
0.0 0.0 1
-3.34033203125 24.0804443359375 99
0.0 0.0 1
-1.521240234375 10.990234375 49
34.38134765625 2.173095703125 102
-1.749267578125 23.7806396484375 83
37.19314765930176 32.37353515625 125
8.653411865234375 -1.8779296875 10
-1.7806396484375 -3.747802734375 3
3.0933837890625 -33.0126953125 121
-4.57513427734375 3.8887939453125 55
-41.813720703125 3.9239044189453125 55
-2.99365234375 5.551704406738281 45
3.343017578125 -2.2655029296875 2
19.47509765625 -16.10107421875 63
-4.71783447265625 -2.142333984375 21
12.068405151367188 10.7789306640625 7
9.92529296875 10.37890625 86
-10.5966796875 14.144287109375 84
48.30810546875 -2.6280517578125 68
-25.6702880859375 13.96112060546875 74
51.375732421875 -11.82550048828125 72
-5.197509765625 3.77410888671875 53
4.6708984375 6.910400390625 64
0.0 0.0 1
-21.8626708984375 -14.4605712890625 64
0.763092041015625 3.897705078125 58
-4.8353271484375 7.2152099609375 52
24.87060546875 -15.143402099609375 40
4.28485107421875 -0.37847900390625 46
2.592987060546875 7.1030120849609375 34
8.81109619140625 19.919921875 32
-5.27001953125 -5.43927001953125 30
-7.8623046875 2.462158203125 26

"""

data4 = """
13.6561279296875 15.950439453125 96
9.8201904296875 -28.177978515625 100
11.48046875 -31.824951171875 32
-0.869384765625 20.465789794921875 100
-19.51318359375 -0.5466461181640625 66
8.0478515625 7.240478515625 14
-4.98223876953125 -23.14691162109375 77
0.107421875 3.5335693359375 5
9.3009033203125 -12.1514892578125 89
6.48828125 -13.306838989257812 32
7.869140625 -13.35302734375 28
-37.9541015625 -11.787460327148438 32
0.0 0.0 1
0.0 0.0 1
-2.60693359375 0.371337890625 3
1.6013164520263672 -6.836669921875 3
-9.998291015625 -7.9827880859375 43
1.6997556686401367 -1.145263671875 3
-10.78582763671875 -12.39453125 11
6.314178466796875 16.384765625 4
0.0 0.0 1
-2.9542236328125 -10.805908203125 11
21.1673583984375 11.36798095703125 45
13.7236328125 -0.491943359375 35
-12.158935546875 28.4178466796875 27
5.314453125 -4.50244140625 19
-1.307861328125 1.1559295654296875 15
-4.115215301513672 -0.0723876953125 3
-9.2998046875 1.185546875 9
"""


lines = data4.strip().split('\n')
displacements_x = []
displacements_y = []

for line in lines:
    parts = line.split()
    displacement_x = float(parts[0])
    displacement_y = float(parts[1])
    if (int(parts[2]) > 2):
        displacements_x.append(displacement_x)
        displacements_y.append(displacement_y)


total_displacement_x = sum(displacements_x)
total_displacement_y = sum(displacements_y)
avg_displacement_x = total_displacement_x/len(displacements_x)
avg_displacement_y = total_displacement_y/len(displacements_y)
new_dis_x = []
new_dis_y = []


for x in displacements_x:
    if (abs(x) <= abs(avg_displacement_x)*200):
        new_dis_x.append(x)


for y in displacements_y:
    if (abs(y) <= abs(avg_displacement_y)*200):
        new_dis_y.append(y)

new_avg_x = sum(new_dis_x)/len(new_dis_x)
new_avg_x = sum(new_dis_y)/len(new_dis_y)

print('AVERAGE DISPLACEMENT X Y ', sum(new_dis_x)
      * 10**(-7), ' ', sum(new_dis_y)*10**(-7))

ids = list(range(1, len(displacements_x)+1))
plt.plot(new_dis_x, range(0, len(new_dis_x)), 'r-', label='Fitted Gaussian')
plt.show()
plt.plot(new_dis_y, range(0, len(new_dis_y)), 'r-', label='Fitted Gaussian')

plt.title('Histogram and Gaussian Fit of Displacement (Full)')
plt.xlabel('Displacement')
plt.ylabel('Frequency')
plt.grid(True)
plt.legend()


plt.show()
